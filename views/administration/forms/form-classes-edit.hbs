<input name="schoolId" type="hidden" data-force-value="true" value="{{currentSchool}}" />
{{#unless edit}}
    <p>Erstelle eine neue Klasse:</p>
{{else}}
    <input type="hidden" name="_id" value="{{class._id}}" />
{{/unless}}

<div class="form-group">
    <label>Schuljahr *</label>

    <select class="linked" name="schoolyear" data-placeholder="Schuljahr auswählen">
        {{#each schoolyears}}
            <option value="{{this._id}}" {{#if this.selected}}selected{{/if}}>
                {{this.name}}
            </option>
        {{/each}}
    </select>
</div>

<div class="form-group">
    <label>Lehrer auswählen (auch später möglich)</label>

    <select name="teacherIds[]" multiple data-placeholder="Lehrer auswählen">
        {{#each teachers}}
            <option value="{{this._id}}" {{#if this.selected}}selected{{/if}} {{#if this.disabled}}disabled{{/if}}>
                {{#if this.displayName}}
                    {{this.displayName}}
                {{else}}
                    {{this.firstName}} {{this.lastName}}
                {{/if}}
            </option>
        {{/each}}
    </select>
</div>

<section id="createnew">
    <div class="row">
        <div class="form-group col-sm-6 col-xs-12">
            <label>Jahrgangsstufe *</label>
            <select class="linked" name="grade" data-placeholder="Jahrgangsstufe wählen" required  {{#if isCustom}}disabled{{/if}}>
                <option disabled selected value>keine Auswahl</option>
                {{#each gradeLevels}}
                    <option value="{{this._id}}" {{#if this.selected}}selected{{/if}}>
                        {{this.name}}
                    </option>
                {{/each}}
            </select>
        </div>
        <div class="form-group col-sm-6 col-xs-12">
            <label>Klassenbezeichnung</label>
            <input class="form-control linked" name="classsuffix" type="text" placeholder="a, b, c, ..., I, II, III, ..., etc." value="{{class.classsuffix}}" {{#if isCustom}}disabled{{/if}}/>
        </div>
    </div>
    <p>Deine Schule passt nicht ins klassische Schema? <a href="#" class="createcustom">Mehr Optionen</a>.</p>
    <section id="createcustom" class="{{#unless isCustom}}hidden{{/unless}}">
        <p>Du kannst Jahrgangsunabhängige Klassen mit freier Bezeichnung erstellen. Diese Klassen können nicht vom Administrator <i>"versetzt"</i> werden, sondern müssen manuell aktualisiert werden.</p>
        <div class="form-group">
            <label>Klassenbezeichnung</label>
            <input class="form-control linked" name="classcustom" type="text" placeholder="z.B. Froschklasse 3-4" required value="{{class.customName}}" {{#unless isCustom}}disabled{{/unless}}/>
        </div>
        <label>
            <input name="keepyear" type="checkbox" value="true" {{#if class.keepYear}}checked{{/if}} {{#unless isCustom}}disabled{{/unless}}/>
            <span>Schuljahreszuordnung beibehalten</span>
        </label>  
    </section>

    <div class="recap">
        <p>Klassenname: 
            <span class="class-default {{#if isCustom}}hidden{{/if}}">
                <span data-from="grade"></span><span data-from="classsuffix"></span>
            </span>
            <span class="class-custom {{#unless isCustom}}hidden{{/unless}}">
                <span data-from="classcustom"></span>
            </span>
        </p>
        <p>Schuljahr: <span data-from="schoolyear"/></p>
    </div>
</section>
<div>

</div>
{{#unless edit}}
    <button class="btn btn-primary w-100 mb-1" type="submit" disabled>Klasse hinzufügen</button>
    {{#userHasPermission 'ADMIN_VIEW'}}
    {{else}}
        <p>Im nächsten Schritt kannst du Schüler zur Klasse einladen oder hinzufügen.</p>
    {{/userHasPermission}}
{{else}}
    <button class="btn btn-primary w-100 mb-1" type="submit" disabled>Änderungen speichern</button>
{{/unless}}


<a href="{{@root.referer}}" class="btn btn-secondary mt-2 w-100">Abbrechen</a>